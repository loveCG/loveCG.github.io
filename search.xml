<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[XMPP连接遇到的问题及解决]]></title>
    <url>%2F2017%2F12%2F22%2FXMPP%E8%BF%9E%E6%8E%A5%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%2F</url>
    <content type="text"><![CDATA[一、11最近使用ejabberd搭建IM服务器，使用smack内库连接XMPP。会一直报一个流错误的异常： 二、221234stream:error (text) at org.jivesoftware.smack.PacketReader.parsePackets(PacketReader.java:251) at org.jivesoftware.smack.PacketReader.access$000(PacketReader.java:46) at org.jivesoftware.smack.PacketReader$1.run(PacketReader.java:72) 三、33查阅了很多资料，发现问题所在:当ejabberd设置max_user_sessions 为n的时候，同一用户使用相同的资源尝试 n+1 连接到服务器，导致正在使用的帐号被别人登录时挤下，然后报出stream:error (text)。正常情况下普通用户会配置互踢，就是max_user_sessions= 1，客户端处理上面流错误实现客户端互踢功能。当管理员想要多个session同时登录，可以在ejabberd上配置： 四、44123max_user_sessions: admin: 10 all: 1 此配置的意思是，普通用户只允许一个session，管理员角色可最多允许10个session同时在线。]]></content>
      <tags>
        <tag>Ejabberd</tag>
      </tags>
  </entry>
</search>
